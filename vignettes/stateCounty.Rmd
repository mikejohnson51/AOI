---
title: "Fiat Boundaries"
vignette: >
  %\VignetteIndexEntry{pkgdown}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---


```{r setup, include = FALSE}

knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.width = 6, 
  fig.height = 4
)

devtools::load_all()
library(kableExtra)
library(dplyr)
library(ggplot2)
library(sf)

mapTheme <- function() {
  theme_void() + 
    theme(
      text = element_text(size = 7),
      plot.title = element_text(size = 11, color = "#1c5074", hjust = 0, vjust = 2, face = "bold"), 
      plot.subtitle = element_text(size = 8, color = "#3474A2", hjust = 0, vjust = 0),
      axis.ticks = element_blank(), 
      legend.direction = "vertical", 
      legend.position = "right",
      plot.margin = margin(1, 1, 1, 1, 'cm'),
      legend.key.height = unit(1, "cm"), legend.key.width = unit(0.4, "cm")
    ) 
}
```

Areas of Interest (AOIs) are geographic boundaries describing a finite region. `AOI` offers two ways to define AOIs including (1) existing fiat boundaries and (2) user-defined bounding boxes. This page focuses on the process for querying fiat boundaries with the central function of AOI, `getAOI`.  AOI offers three in-package datasets representing the spatial boundaries of USA states and counties and global countries. The can be accessed via the `state`, `county`, and `world` state data object calls. Help files for each dataset are available via the `?` call (e.g. ?states). 

# Quering Fiat Boundaries {.tabset .tabset-fade}

## AOI by **country**

Simplified country boundaries can be queried with `getAOI()` using the `country=` parameter. In total, 246 countries boundaries are available in AOI and are derived from [Natural Earth](https://www.naturalearthdata.com/downloads/50m-cultural-vectors/50m-admin-0-countries-2/). The data is joined to a working database of the CIA \href{https://www.cia.gov/library/publications/the-world-factbook/}{World Factbook}.

### 1.1 Querying Country Boundary Data

```{r, message = FALSE}
getAOI(country = 'CR') %>% check(returnMap = T)

getAOI(country = c('Brazil', 'Peru', "chili")) %>% check(returnMap = T)

```

##  AOI by **state**  

An AOI can be defined by a **state** name or abbreviation:

```{r, message = FALSE}
getAOI(state = 'CA') %>% check(returnMap = T)
```

A query can also be defined using multiple **states** provided as a vector:

```{r, message = FALSE}
getAOI(state = c("Oregon", "Washington", "CA")) %>% check(returnMap = TRUE)
```

If you want the lower 48 USA state you can query `state = 'conus'`. Moreover, 
calls to `country` can be mixed with calls to `state`.

```{r, message = FALSE}
getAOI(country = 'Mexico', state = "conus") %>% check(returnMap = TRUE)
```

## AOI by **county** 

### Defining an AOI by **county** requires a **state** as well:

If you want to get the boundaries of a state with the county features intact, simply call getAOI and set `county = 'all'`

```{r, message = FALSE}
getAOI(state = "AL", county = 'all') %>% check(returnMap = TRUE)
```

Or if you want a single county, in a state:

```{r, message = FALSE}
getAOI(state = "CO", county = "El Paso") %>% check(returnMap = TRUE)
```

Or multiple counties in the same state:

```{r, message = F}
getAOI(state ="CA", county = c("Santa Barbara", "San Luis Obispo", "Ventura")) %>% check(returnMap = T)
```

Or counties in different states

```{r, message = F}
getAOI(state =c("CA", "CO"), county = c("Santa Barbara", "El Paso")) %>% check(returnMap = T)
```
<br>

## Unioning

```{r, messages = FALSE}
getAOI(state = c('CA', 'OR'), union = TRUE) %>% check(returnMap = TRUE)

```

## CIA World Factbook Data

```{r, message=FALSE, warning=FALSE}
ca = AOI::countries %>% 
  filter(subregion =="Central America") %>% 
  select("birth_rate", "name") %>% 
  cbind(st_coordinates(st_centroid(.))) 

# Plot

ggplot(ca) +
  geom_sf(aes(fill = birth_rate ), color = NA) +
  scale_fill_gradient("Birth Rate\n") +
  geom_label(aes(X,Y, label = name), alpha = 0.8, size = 2) +
  labs(
    title = 'CIA World Factbook',
    subtitle = "Birth Rate",
    caption = "Source: CIA World Factbook"
  ) + mapTheme()

```



Now that you have a good understanding of how to call existing fiat boundaries take a look at the [Clip Areas](./articles/clipAreas.html) page to learn how to define your own extents!
