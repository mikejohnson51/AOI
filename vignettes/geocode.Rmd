---
title: "Geocoding"
vignette: >
  %\VignetteIndexEntry{pkgdown}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.width = 6, 
  fig.height = 4
)

devtools::load_all()
library(leaflet)
library(sp)

col  = '#1c26a9'
col1 = '#212f3f'

icon.r <- awesomeIcons(
    icon='home',
    iconColor = col1,
    markerColor = "gray",
    library='fa')

icon.b <- awesomeIcons(
    icon='home',
    iconColor = col1,
    markerColor = 138,
    library='fa')

```


At times users will want to look up information about a location (either lat/long or character). For these cases `AOI` offers a geocoding (and reverse geocoding) interface built into the geoCode function.

For example, I am a big fan of the restaurant "Rasta Pasta" in downtown Colorado Springs, but finding the spatial information regarding this location (such as lat/lon, address, city, ect) can be difficult. For this the geoCode function can be handy.

##*Geocoding*:

Here we use AOI's geocode to find the lat/lon of the Grand Canyon, using both the colloquial name, and the (lat/long) pair found with a <a target="_blank"href="http://www.Google.com/search?q=grand+canyon+lat+long">Google search.</a> Notice slightly different locations are generated:

```{r, message = F}
GC_name = geocode("grand canyon")
GC_lat_lon = getAOI(clip = list(36.0544, -112.1401, 10, 10))
```

```{r, echo = FALSE}

latlon = "<strong>Query by Lat Long</strong>"
API = "<strong>Geocode by Name</strong>"
gc = geocode("grand canyon")

leaflet(option=leafletOptions(zoomControl= FALSE, minZoom = 10, maxZoom = 10)) %>% addProviderTiles(providers$CartoDB.Positron) %>% 
   #addPolygons(data = GC_name, fillColor = "transparent", color = col, weight = 4)  %>% 
   #addPolygons(data = GC_lat_lon, fillColor = "transparent", color = col1, weight = 4) %>% 
   addAwesomeMarkers(icon = icon.b, lat = gc$lat, lng = gc$lon, popup = API) %>% 
   addAwesomeMarkers(icon = icon.r, lat = 36.0544 , lng = -112.1401, popup = latlon)
```

```{r, message = F}
GC = geocode("grand canyon", bb = T)
GC
```

```{r, echo = FALSE}
leaflet(option=leafletOptions(zoomControl= FALSE, minZoom = 13, maxZoom = 13)) %>% addProviderTiles(providers$CartoDB.Positron) %>% 
   addPolygons(data = GC$bb, fillColor = "transparent", color = col, weight = 4) 
```


##*Reverse Geocoding example*:

```{r}
revgeocode(c(38,-104))
```


```{r}
rc = revgeocode("UCSB")
print(rc)
```

Each of these values can be isolates with the `$` operator:

```{r}
rc$match_addr
```

The bounding box parameter can be used as input as to osmbb_sp to generated a spatial geometry for the region.

```{r}
osmbb_sp(rc$bb)
```

```{r}
leaflet(option=leafletOptions(zoomControl= FALSE, minZoom = 14, maxZoom = 14)) %>% addProviderTiles(providers$CartoDB.Positron) %>% 
addPolygons(data = osmbb_sp(rc$bb),fillColor = "transparent", color = col, weight = 4, label = "Tall: list('National Water Center, AL', 30, 10)")

```
