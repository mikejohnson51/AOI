---
title: "Clip based AOI"
vignette: >
  %\VignetteIndexEntry{pkgdown}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.width = 6, 
  fig.height = 4
)

devtools::load_all()
library(leaflet)
library(sp)

col  = '#1c26a9'
col1 = '#212f3f'

icon.r <- awesomeIcons(
    icon='home',
    iconColor = col1,
    markerColor = "gray",
    library='fa')

icon.b <- awesomeIcons(
    icon='home',
    iconColor = col1,
    markerColor = 138,
    library='fa')

```

In `AOI` a **clip** is user defined region. Most commonly a bounding box or a supplied spatial object - both of which can be used as input. 

# Clip by list()

To define a bounding box **clip**,  requires four inputs given as a list:

(1) A location   
(2) A bounding box height 
(3) A bounding box width 
(4) A location origin (default = 'center')   

Again, all **clip** inputs **must** be provided as a list and order **DOES** matter if each parameter is not explicitly assigned (eg `h = 10`). Examples for each input follow: 

##1. Location

A Location is the first input in  **clip** list and can be given as a colloquial name (*character string*) or as a (lat/long) pair (*numeric*). Names are geocoded via the Google API. 

##*Location example*:

Here we query an AOI surrounding the Grand Canyon, using both the colloquial name, and the (lat/long) pair found with a <a target="_blank"href="http://www.Google.com/search?q=grand+canyon+lat+long">Google search.</a> Notice slightly different locations are generated:

```{r, message = F}
GC_name = getAOI(clip = list("grand canyon", 10, 10))

GC_lat_lon = getAOI(clip = list(36.0544, -112.1401, 10, 10))
```

```{r, echo = FALSE}

latlon = "<strong>Query by Lat Long</strong>"
API = "<strong>Query by Name</strong>"
gc = getPoint("grand canyon")

leaflet(option=leafletOptions(zoomControl= FALSE, minZoom = 10, maxZoom = 10)) %>% addProviderTiles(providers$CartoDB.Positron) %>% 
   addPolygons(data = GC_name, fillColor = "transparent", color = col, weight = 4)  %>% 
   addPolygons(data = GC_lat_lon, fillColor = "transparent", color = col1, weight = 4) %>% 
   addAwesomeMarkers(icon = icon.b, lat = gc$lat, lng = gc$lon, popup = API) %>% 
   addAwesomeMarkers(icon = icon.r, lat = 36.0544 , lng = -112.1401, popup = latlon)

```

##2. Bounding box height and width

Once a location is specified, the next needed values are a bounding box height and width. The first entry defines height and the second width: 
  
##*Bounding box diminsions example*:

```{r, message = FALSE}
nwc.tall = getAOI(clip = list("National Water Center, AL", 30, 10))
nwc.wide = getAOI(clip = list("National Water Center, AL", 10, 30))
```

```{r, echo = FALSE}
nwc = getPoint("National Water Center, AL")

leaflet(option=leafletOptions(zoomControl= FALSE, minZoom = 9, maxZoom = 9)) %>% addProviderTiles(providers$CartoDB.Positron) %>% 
  addPolygons(data = nwc.tall,fillColor = "transparent", color = col, weight = 4, label = "Tall: list('National Water Center, AL', 30, 10)") %>%  
  addPolygons(data = nwc.wide, fillColor = "transparent", color = col1, weight = 4, label = "Wide: list('National Water Center, AL', 10, 30)") %>% 
  addAwesomeMarkers(icon = icon.b, lat = nwc$lat, lng = nwc$lon, popup = "National Water Center")

```

##3. Origin

With a location, height, and width defined the relationship of the box to the location is needed. By default (and in the previous examples) each bounding box was generated using the location as a centroid. You can change this by adding a final argument to the **clip** list specifying where the location lies in reference to the box. Options include 'center', 'lowerleft', 'lowerright', 'upperleft', 'upperright':
  
  ##*Origin example*:
  
  ```{r, message = FALSE}
ucsb.c =  getAOI(clip = list("UCSB", 10, 10, "center"))
ucsb.ul = getAOI(clip = list("UCSB", 10, 10, "upperleft"))
ucsb.ur = getAOI(clip = list("UCSB", 10, 10, "upperright"))
ucsb.ll = getAOI(clip = list("UCSB", 10, 10, "lowerleft"))
ucsb.lr = getAOI(clip = list("UCSB", 10, 10, "lowerright"))
```

```{r, echo = FALSE}
leaflet(option=leafletOptions(zoomControl= FALSE, minZoom = 10, maxZoom = 10)) %>% addProviderTiles(providers$CartoDB.Positron) %>% 
  addPolygons(data = ucsb.ul, fillColor = "transparent", color = col1, weight = 4, label = "upperleft") %>% 
  addPolygons(data = ucsb.ur, fillColor = "transparent", color = col1, weight = 4, label = "upperright") %>% 
  addPolygons(data = ucsb.ll, fillColor = "transparent", color = col1, weight = 4, label = "lowerleft") %>% 
  addPolygons(data = ucsb.lr, fillColor = "transparent", color = col1, weight = 4, label = "lowerright") %>% 
  addPolygons(data = ucsb.c,  fillColor = col1, color = col,  weight = 4, label = "center") %>% 
  addAwesomeMarkers(icon = icon.b, lat = 34.41396, lng = -119.8489, popup = 'UCSB')
```

#Clip by Spatial*

A user supplied shapefile can  be used as input for the clip parameter in lieu of a list() bounding box.

##*Spatial example*:

```{r, message = FALSE}
#Read in shapefile of all Los Angeles Communities
LA = rgdal::readOGR("./shp/LA.shp", verbose = FALSE)
#Subset Santa Monica
SM = LA[LA$LABEL_CITY == 'Santa Monica',] %>% spTransform(aoiProj)
#Define AOI
AOI = getAOI(clip = SM)
getwd()
```

```{r, echo = FALSE}
leaflet(option=leafletOptions(zoomControl= FALSE, minZoom = 12, maxZoom = 12)) %>% addProviderTiles(providers$CartoDB.Positron) %>% 
  addPolygons(data = SM, fillColor = 'transparent', color = 'black', weight = 1) %>% 
  addPolygons(data = AOI,fillColor = col, color = col1, weight = 4, label = "Santa Monica")
```

Now that you know what it takes to define an AOI covering any region you want, take a look at the [AOI Tools](./docs/articles/tools.html) page to learn how to define, refine, manipulate, and describe your extents! Be sure to also check out the AOI package in action on [use cases](./doc/articles/useCases.html) page. 
